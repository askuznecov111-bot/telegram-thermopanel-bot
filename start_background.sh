
#!/bin/bash

# ะกะบัะธะฟั ะดะปั ะทะฐะฟััะบะฐ ะฑะพัะฐ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต

echo "๐ ะะฐะฟััะบ Telegram ะฑะพัะฐ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต..."

# ะะตัะตัะพะด ะฒ ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ
cd "$(dirname "$0")"

# ะัะพะฒะตัะบะฐ, ะฝะต ะทะฐะฟััะตะฝ ะปะธ ัะถะต ะฑะพั
if pgrep -f "python.*bot.py" > /dev/null; then
    echo "โ๏ธ  ะะพั ัะถะต ะทะฐะฟััะตะฝ!"
    echo "ะััะฐะฝะพะฒะธัะต ะตะณะพ ะบะพะผะฐะฝะดะพะน: ./stop.sh"
    exit 1
fi

# ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะฒะธัััะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั
if [ ! -d "venv" ]; then
    echo "โ ะะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต ะฝะต ะฝะฐะนะดะตะฝะพ!"
    echo "๐ฆ ะะฐะฟัััะธัะต ัะฝะฐัะฐะปะฐ: ./start.sh"
    exit 1
fi

# ะะฐะฟััะบ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต ั ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธะตะผ ะฒัะฒะพะดะฐ
# ะัะฟะพะปัะทัะตะผ python ะธะท ะฒะธัััะฐะปัะฝะพะณะพ ะพะบััะถะตะฝะธั ะฝะฐะฟััะผัั
nohup ./venv/bin/python bot.py > bot.log 2>&1 &

PID=$!
echo "โ ะะพั ะทะฐะฟััะตะฝ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต (PID: $PID)"
echo "๐ ะะพะณะธ: tail -f bot.log"
echo "๐ ะััะฐะฝะพะฒะบะฐ: ./stop.sh"
