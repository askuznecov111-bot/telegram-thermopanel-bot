
#!/bin/bash

# Скрипт для запуска бота в фоновом режиме

echo "🚀 Запуск Telegram бота в фоновом режиме..."

# Переход в директорию проекта
cd "$(dirname "$0")"

# Проверка, не запущен ли уже бот
if pgrep -f "python.*bot.py" > /dev/null; then
    echo "⚠️  Бот уже запущен!"
    echo "Остановите его командой: ./stop.sh"
    exit 1
fi

# Проверка наличия виртуального окружения
if [ ! -d "venv" ]; then
    echo "❌ Виртуальное окружение не найдено!"
    echo "📦 Запустите сначала: ./start.sh"
    exit 1
fi

# Запуск в фоновом режиме с перенаправлением вывода
# Используем python из виртуального окружения напрямую
nohup ./venv/bin/python bot.py > bot.log 2>&1 &

PID=$!
echo "✅ Бот запущен в фоновом режиме (PID: $PID)"
echo "📊 Логи: tail -f bot.log"
echo "🛑 Остановка: ./stop.sh"
